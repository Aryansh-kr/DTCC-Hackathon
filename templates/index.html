<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Neo4j Graph Browser</title>
    <script src="https://cdn.jsdelivr.net/npm/neovis.js@2.0.2"></script>
    <style>
        body {
            font-family: "Courier New", monospace;
            margin: 0;
            padding: 0;
            background: #1e1e1e;
            color: #f0f0f0;
        }

        h1 {
            text-align: center;
            margin: 10px;
            color: #00a9e0;
        }

        #cypher-panel {
            display: flex;
            padding: 10px;
            background: #2b2b2b;
            border-bottom: 1px solid #444;
        }

        #cypher-input {
            flex: 1;
            padding: 10px;
            font-size: 16px;
            background: #1e1e1e;
            color: #fff;
            border: 1px solid #555;
            margin-right: 10px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #00a9e0;
            color: #fff;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background-color: #007bb5;
        }

        #viz {
            width: 100%;
            height: 75vh;
            background: #1e1e1e;
        }

        #node-info {
            padding: 15px;
            background: #2b2b2b;
            border-top: 1px solid #444;
            color: #eee;
            height: 12vh;
            overflow-y: auto;
        }

        .key {
            font-weight: bold;
            color: #00a9e0;
        }
    </style>
</head>
<body>
    <h1>Neo4j Graph Browser</h1>

    <div id="cypher-panel">
        <input type="text" id="cypher-input" placeholder="MATCH (n)-[r]->(m) RETURN n, r, m LIMIT 25">
        <button onclick="runCypherQuery()">Run</button>
    </div>

    <div id="viz"></div>
    <div id="node-info">Click on a node to see details here...</div>

    <script type="text/javascript">
        const config = {
            containerId: "viz",
            neo4j: {
                serverUrl: "bolt://localhost:7687",
                serverUser: "neo4j",
                serverPassword: "12345678"
            },
            labels: {
                Entity: {
                    label: "name",
                    font: {
                        size: 18,
                        color: "#ffffff",
                        face: "Courier New"
                    },
                    size: 30,
                    color: {
                        background: "#4e9af1",
                        border: "#007bff",
                        highlight: {
                            background: "#5bc0de",
                            border: "#17a2b8"
                        }
                    },
                    shape: "dot"
                },
                Regulation: {
                    label: "title",
                    size: 25,
                    color: {
                        background: "#28a745",
                        border: "#1c7c33"
                    }
                }
            },
            relationships: {
                RELATION: {
                    caption: "type",
                    font: {
                        size: 12,
                        color: "#f0f0f0",
                        align: "middle",
                        face: "Courier New"
                    },
                    color: "#ff6b6b",
                    arrows: {
                        to: { enabled: true, scaleFactor: 1.1 }
                    },
                    smooth: { enabled: true, type: "curvedCW" }
                },
                REFERENCES: {
                    caption: "type",
                    color: "#ffa500"
                }
            },
            initialCypher: "MATCH (a:Entity)-[r:RELATION]->(b:Entity) RETURN a, r, b LIMIT 25",
            visConfig: {
                nodes: {
                    borderWidth: 2,
                    shadow: true
                },
                edges: {
                    smooth: { type: "dynamic" }
                },
                physics: {
                    enabled: true,
                    solver: "forceAtlas2Based",
                    forceAtlas2Based: {
                        gravitationalConstant: -50,
                        springLength: 150,
                        springConstant: 0.08
                    },
                    stabilization: { iterations: 100 }
                }
            }
        };

        const viz = new NeoVis.default(config);

        function runCypherQuery() {
            const query = document.getElementById("cypher-input").value;
            if (query.trim() !== "") {
                viz.renderWithCypher(query);
            }
        }

        viz.registerOnEvent("completed", () => {
            console.log("Graph loaded.");
        });

        viz.registerOnEvent("clickNode", (event) => {
            const props = event.node.properties;
            let html = `<strong>Node Details:</strong><br>`;
            for (let key in props) {
                html += `<span class="key">${key}</span>: ${props[key]}<br>`;
            }
            document.getElementById("node-info").innerHTML = html;
        });

        viz.render();
    </script>
</body>
</html>
